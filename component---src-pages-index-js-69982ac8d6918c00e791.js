/*! For license information please see component---src-pages-index-js-69982ac8d6918c00e791.js.LICENSE.txt */
"use strict";(self.webpackChunkquick_chess=self.webpackChunkquick_chess||[]).push([[678],{3204:function(e){const t=/[\p{Lu}]/u,r=/[\p{Ll}]/u,n=/^[\p{Lu}](?![\p{Lu}])/gu,i=/([\p{Alpha}\p{N}_]|$)/u,o=/[_.\- ]+/,s=new RegExp("^"+o.source),a=new RegExp(o.source+i.source,"gu"),c=new RegExp("\\d+"+i.source,"gu"),l=(e,i)=>{if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");if(i={pascalCase:!1,preserveConsecutiveUppercase:!1,...i},0===(e=Array.isArray(e)?e.map((e=>e.trim())).filter((e=>e.length)).join("-"):e.trim()).length)return"";const o=!1===i.locale?e=>e.toLowerCase():e=>e.toLocaleLowerCase(i.locale),l=!1===i.locale?e=>e.toUpperCase():e=>e.toLocaleUpperCase(i.locale);if(1===e.length)return i.pascalCase?l(e):o(e);return e!==o(e)&&(e=((e,n,i)=>{let o=!1,s=!1,a=!1;for(let c=0;c<e.length;c++){const l=e[c];o&&t.test(l)?(e=e.slice(0,c)+"-"+e.slice(c),o=!1,a=s,s=!0,c++):s&&a&&r.test(l)?(e=e.slice(0,c-1)+"-"+e.slice(c-1),a=s,s=!1,o=!0):(o=n(l)===l&&i(l)!==l,a=s,s=i(l)===l&&n(l)!==l)}return e})(e,o,l)),e=e.replace(s,""),e=i.preserveConsecutiveUppercase?((e,t)=>(n.lastIndex=0,e.replace(n,(e=>t(e)))))(e,o):o(e),i.pascalCase&&(e=l(e.charAt(0))+e.slice(1)),((e,t)=>(a.lastIndex=0,c.lastIndex=0,e.replace(a,((e,r)=>t(r))).replace(c,(e=>t(e)))))(e,l)};e.exports=l,e.exports.default=l},4063:function(e){e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},8032:function(e,t,r){r.d(t,{G:function(){return L},L:function(){return f},M:function(){return E},P:function(){return S},_:function(){return a},a:function(){return s},b:function(){return u},g:function(){return d},h:function(){return c}});var n=r(7294),i=(r(3204),r(5697)),o=r.n(i);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function a(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(i[r]=e[r]);return i}const c=()=>"undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;function l(e,t,r){const n={};let i="gatsby-image-wrapper";return"fixed"===r?(n.width=e,n.height=t):"constrained"===r&&(i="gatsby-image-wrapper gatsby-image-wrapper-constrained"),{className:i,"data-gatsby-image-wrapper":"",style:n}}function u(e,t,r,n,i){return void 0===i&&(i={}),s({},r,{loading:n,shouldLoad:e,"data-main-image":"",style:s({},i,{opacity:t?1:0})})}function d(e,t,r,n,i,o,a,c){const l={};o&&(l.backgroundColor=o,"fixed"===r?(l.width=n,l.height=i,l.backgroundColor=o,l.position="relative"):("constrained"===r||"fullWidth"===r)&&(l.position="absolute",l.top=0,l.left=0,l.bottom=0,l.right=0)),a&&(l.objectFit=a),c&&(l.objectPosition=c);const u=s({},e,{"aria-hidden":!0,"data-placeholder-image":"",style:s({opacity:t?0:1,transition:"opacity 500ms linear"},l)});return u}const h=["children"],g=function(e){let{layout:t,width:r,height:i}=e;return"fullWidth"===t?n.createElement("div",{"aria-hidden":!0,style:{paddingTop:i/r*100+"%"}}):"constrained"===t?n.createElement("div",{style:{maxWidth:r,display:"block"}},n.createElement("img",{alt:"",role:"presentation","aria-hidden":"true",src:`data:image/svg+xml;charset=utf-8,%3Csvg%20height='${i}'%20width='${r}'%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%3E%3C/svg%3E`,style:{maxWidth:"100%",display:"block",position:"static"}})):null},f=function(e){let{children:t}=e,r=a(e,h);return n.createElement(n.Fragment,null,n.createElement(g,s({},r)),t,null)},p=["src","srcSet","loading","alt","shouldLoad"],m=["fallback","sources","shouldLoad"],v=function(e){let{src:t,srcSet:r,loading:i,alt:o="",shouldLoad:c}=e,l=a(e,p);return n.createElement("img",s({},l,{decoding:"async",loading:i,src:c?t:void 0,"data-src":c?void 0:t,srcSet:c?r:void 0,"data-srcset":c?void 0:r,alt:o}))},b=function(e){let{fallback:t,sources:r=[],shouldLoad:i=!0}=e,o=a(e,m);const c=o.sizes||(null==t?void 0:t.sizes),l=n.createElement(v,s({},o,t,{sizes:c,shouldLoad:i}));return r.length?n.createElement("picture",null,r.map((e=>{let{media:t,srcSet:r,type:o}=e;return n.createElement("source",{key:`${t}-${o}-${r}`,type:o,media:t,srcSet:i?r:void 0,"data-srcset":i?void 0:r,sizes:c})})),l):l};var y;v.propTypes={src:i.string.isRequired,alt:i.string.isRequired,sizes:i.string,srcSet:i.string,shouldLoad:i.bool},b.displayName="Picture",b.propTypes={alt:i.string.isRequired,shouldLoad:i.bool,fallback:i.exact({src:i.string.isRequired,srcSet:i.string,sizes:i.string}),sources:i.arrayOf(i.oneOfType([i.exact({media:i.string.isRequired,type:i.string,sizes:i.string,srcSet:i.string.isRequired}),i.exact({media:i.string,type:i.string.isRequired,sizes:i.string,srcSet:i.string.isRequired})]))};const _=["fallback"],S=function(e){let{fallback:t}=e,r=a(e,_);return t?n.createElement(b,s({},r,{fallback:{src:t},"aria-hidden":!0,alt:""})):n.createElement("div",s({},r))};S.displayName="Placeholder",S.propTypes={fallback:i.string,sources:null==(y=b.propTypes)?void 0:y.sources,alt:function(e,t,r){return e[t]?new Error(`Invalid prop \`${t}\` supplied to \`${r}\`. Validation failed.`):null}};const E=function(e){return n.createElement(n.Fragment,null,n.createElement(b,s({},e)),n.createElement("noscript",null,n.createElement(b,s({},e,{shouldLoad:!0}))))};E.displayName="MainImage",E.propTypes=b.propTypes;const w=["as","className","class","style","image","loading","imgClassName","imgStyle","backgroundColor","objectFit","objectPosition"],D=["style","className"],O=e=>e.replace(/\n/g,""),I=function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),s=3;s<n;s++)i[s-3]=arguments[s];return e.alt||""===e.alt?o().string.apply(o(),[e,t,r].concat(i)):new Error(`The "alt" prop is required in ${r}. If the image is purely presentational then pass an empty string: e.g. alt="". Learn more: https://a11y-style-guide.com/style-guide/section-media.html`)},T={image:o().object.isRequired,alt:I},C=["as","image","style","backgroundColor","className","class","onStartLoad","onLoad","onError"],k=["style","className"],P=new Set;let N,R;const x=function(e){let{as:t="div",image:i,style:o,backgroundColor:u,className:d,class:h,onStartLoad:g,onLoad:f,onError:p}=e,m=a(e,C);const{width:v,height:b,layout:y}=i,_=l(v,b,y),{style:S,className:E}=_,w=a(_,k),D=(0,n.useRef)(),O=(0,n.useMemo)((()=>JSON.stringify(i.images)),[i.images]);h&&(d=h);const I=function(e,t,r){let n="";return"fullWidth"===e&&(n=`<div aria-hidden="true" style="padding-top: ${r/t*100}%;"></div>`),"constrained"===e&&(n=`<div style="max-width: ${t}px; display: block;"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height='${r}'%20width='${t}'%20xmlns='http://www.w3.org/2000/svg'%20version='1.1'%3E%3C/svg%3E" style="max-width: 100%; display: block; position: static;"></div>`),n}(y,v,b);return(0,n.useEffect)((()=>{N||(N=r.e(731).then(r.bind(r,6731)).then((e=>{let{renderImageToString:t,swapPlaceholderImage:r}=e;return R=t,{renderImageToString:t,swapPlaceholderImage:r}})));const e=D.current.querySelector("[data-gatsby-image-ssr]");if(e&&c())return e.complete?(null==g||g({wasCached:!0}),null==f||f({wasCached:!0}),setTimeout((()=>{e.removeAttribute("data-gatsby-image-ssr")}),0)):(null==g||g({wasCached:!0}),e.addEventListener("load",(function t(){e.removeEventListener("load",t),null==f||f({wasCached:!0}),setTimeout((()=>{e.removeAttribute("data-gatsby-image-ssr")}),0)}))),void P.add(O);if(R&&P.has(O))return;let t,n;return N.then((e=>{let{renderImageToString:r,swapPlaceholderImage:a}=e;D.current&&(D.current.innerHTML=r(s({isLoading:!0,isLoaded:P.has(O),image:i},m)),P.has(O)||(t=requestAnimationFrame((()=>{D.current&&(n=a(D.current,O,P,o,g,f,p))}))))})),()=>{t&&cancelAnimationFrame(t),n&&n()}}),[i]),(0,n.useLayoutEffect)((()=>{P.has(O)&&R&&(D.current.innerHTML=R(s({isLoading:P.has(O),isLoaded:P.has(O),image:i},m)),null==g||g({wasCached:!0}),null==f||f({wasCached:!0}))}),[i]),(0,n.createElement)(t,s({},w,{style:s({},S,o,{backgroundColor:u}),className:`${E}${d?` ${d}`:""}`,ref:D,dangerouslySetInnerHTML:{__html:I},suppressHydrationWarning:!0}))},L=(0,n.memo)((function(e){return e.image?(0,n.createElement)(x,e):null}));L.propTypes=T,L.displayName="GatsbyImage";const M=["src","__imageData","__error","width","height","aspectRatio","tracedSVGOptions","placeholder","formats","quality","transformOptions","jpgOptions","pngOptions","webpOptions","avifOptions","blurredOptions","breakpoints","outputPixelDensities"];function A(e){return function(t){let{src:r,__imageData:i,__error:o}=t,c=a(t,M);return o&&console.warn(o),i?n.createElement(e,s({image:i},c)):(console.warn("Image not loaded",r),null)}}const j=A((function(e){let{as:t="div",className:r,class:i,style:o,image:c,loading:h="lazy",imgClassName:g,imgStyle:p,backgroundColor:m,objectFit:v,objectPosition:b}=e,y=a(e,w);if(!c)return console.warn("[gatsby-plugin-image] Missing image prop"),null;i&&(r=i),p=s({objectFit:v,objectPosition:b,backgroundColor:m},p);const{width:_,height:I,layout:T,images:C,placeholder:k,backgroundColor:P}=c,N=l(_,I,T),{style:R,className:x}=N,L=a(N,D),M={fallback:void 0,sources:[]};return C.fallback&&(M.fallback=s({},C.fallback,{srcSet:C.fallback.srcSet?O(C.fallback.srcSet):void 0})),C.sources&&(M.sources=C.sources.map((e=>s({},e,{srcSet:O(e.srcSet)})))),n.createElement(t,s({},L,{style:s({},R,o,{backgroundColor:m}),className:`${x}${r?` ${r}`:""}`}),n.createElement(f,{layout:T,width:_,height:I},n.createElement(S,s({},d(k,!1,T,_,I,P,v,b))),n.createElement(E,s({"data-gatsby-image-ssr":"",className:g},y,u("eager"===h,!1,M,h,p)))))})),q=function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return"fullWidth"!==e.layout||"width"!==t&&"height"!==t||!e[t]?o().number.apply(o(),[e,t].concat(n)):new Error(`"${t}" ${e[t]} may not be passed when layout is fullWidth.`)},H=new Set(["fixed","fullWidth","constrained"]),U={src:o().string.isRequired,alt:I,width:q,height:q,sizes:o().string,layout:e=>{if(void 0!==e.layout&&!H.has(e.layout))return new Error(`Invalid value ${e.layout}" provided for prop "layout". Defaulting to "constrained". Valid values are "fixed", "fullWidth" or "constrained".`)}};j.displayName="StaticImage",j.propTypes=U;const $=A(L);$.displayName="StaticImage",$.propTypes=U},7989:function(e,t,r){r.r(t),r.d(t,{Head:function(){return sr},default:function(){return or}});var n={};r.r(n),r.d(n,{FILE:function(){return ot},HTML:function(){return ct},TEXT:function(){return at},URL:function(){return st}});var i=r(7294),o=r(4160),s=r(5785);const a="w",c="b",l="p",u="b",d="r",h="q",g="k",f="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";class p{color;from;to;piece;captured;promotion;flags;san;lan;before;after;constructor(e,t){const{color:r,piece:n,from:i,to:o,flags:s,captured:a,promotion:c}=t,l=L(i),u=L(o);this.color=r,this.piece=n,this.from=l,this.to=u,this.san=e._moveToSan(t,e._moves({legal:!0})),this.lan=l+u,this.before=e.fen(),e._makeMove(t),this.after=e.fen(),e._undoMove(),this.flags="";for(const d in y)y[d]&s&&(this.flags+=v[d]);a&&(this.captured=a),c&&(this.promotion=c,this.lan+=c)}isCapture(){return this.flags.indexOf(v.CAPTURE)>-1}isPromotion(){return this.flags.indexOf(v.PROMOTION)>-1}isEnPassant(){return this.flags.indexOf(v.EP_CAPTURE)>-1}isKingsideCastle(){return this.flags.indexOf(v.KSIDE_CASTLE)>-1}isQueensideCastle(){return this.flags.indexOf(v.QSIDE_CASTLE)>-1}isBigPawn(){return this.flags.indexOf(v.BIG_PAWN)>-1}}const m=-1,v={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},b=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],y={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},_={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},S={b:[16,32,17,15],w:[-16,-32,-17,-15]},E={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},w=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],D=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],O={p:1,n:2,b:4,r:8,q:16,k:32},I=["n",u,d,h],T={[g]:y.KSIDE_CASTLE,[h]:y.QSIDE_CASTLE},C={w:[{square:_.a1,flag:y.QSIDE_CASTLE},{square:_.h1,flag:y.KSIDE_CASTLE}],b:[{square:_.a8,flag:y.QSIDE_CASTLE},{square:_.h8,flag:y.KSIDE_CASTLE}]},k={b:1,w:6},P=["1-0","0-1","1/2-1/2","*"];function N(e){return e>>4}function R(e){return 15&e}function x(e){return-1!=="0123456789".indexOf(e)}function L(e){const t=R(e),r=N(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function M(e){return e===a?c:a}function A(e,t,r,n,i,o=void 0,s=y.NORMAL){const a=N(n);if(i!==l||7!==a&&0!==a)e.push({color:t,from:r,to:n,piece:i,captured:o,flags:s});else for(let c=0;c<I.length;c++){const a=I[c];e.push({color:t,from:r,to:n,piece:i,captured:o,promotion:a,flags:s|y.PROMOTION})}}function j(e){let t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return l}return t=t.toLowerCase(),"o"===t?g:t}function q(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function H(e){return e.split(" ").slice(0,4).join(" ")}class U{_board=new Array(128);_turn=a;_header={};_kings={w:m,b:m};_epSquare=-1;_halfMoves=0;_moveNumber=0;_history=[];_comments={};_castling={w:0,b:0};_positionCount={};constructor(e=f,{skipValidation:t=!1}={}){this.load(e,{skipValidation:t})}clear({preserveHeaders:e=!1}={}){this._board=new Array(128),this._kings={w:m,b:m},this._turn=a,this._castling={w:0,b:0},this._epSquare=m,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._positionCount={},delete this._header.SetUp,delete this._header.FEN}load(e,{skipValidation:t=!1,preserveHeaders:r=!1}={}){let n=e.split(/\s+/);if(n.length>=2&&n.length<6){const t=["-","-","0","1"];e=n.concat(t.slice(-(6-n.length))).join(" ")}if(n=e.split(/\s+/),!t){const{ok:t,error:r}=function(e){const t=e.split(/\s+/);if(6!==t.length)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const r=parseInt(t[5],10);if(isNaN(r)||r<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const n=parseInt(t[4],10);if(isNaN(n)||n<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(t[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(t[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const i=t[0].split("/");if(8!==i.length)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let s=0;s<i.length;s++){let e=0,t=!1;for(let r=0;r<i[s].length;r++)if(x(i[s][r])){if(t)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};e+=parseInt(i[s][r],10),t=!0}else{if(!/^[prnbqkPRNBQK]$/.test(i[s][r]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};e+=1,t=!1}if(8!==e)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if("3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1])return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const o=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:s,regex:a}of o){if(!a.test(t[0]))return{ok:!1,error:`Invalid FEN: missing ${s} king`};if((t[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${s} kings`}}return Array.from(i[0]+i[7]).some((e=>"P"===e.toUpperCase()))?{ok:!1,error:"Invalid FEN: some pawns are on the edge rows"}:{ok:!0}}(e);if(!t)throw new Error(r)}const i=n[0];let o=0;this.clear({preserveHeaders:r});for(let s=0;s<i.length;s++){const e=i.charAt(s);if("/"===e)o+=8;else if(x(e))o+=parseInt(e,10);else{const t=e<"a"?a:c;this._put({type:e.toLowerCase(),color:t},L(o)),o++}}this._turn=n[1],n[2].indexOf("K")>-1&&(this._castling.w|=y.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(this._castling.w|=y.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(this._castling.b|=y.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(this._castling.b|=y.QSIDE_CASTLE),this._epSquare="-"===n[3]?m:_[n[3]],this._halfMoves=parseInt(n[4],10),this._moveNumber=parseInt(n[5],10),this._updateSetup(e),this._incPositionCount(e)}fen(){let e=0,t="";for(let i=_.a8;i<=_.h1;i++){if(this._board[i]){e>0&&(t+=e,e=0);const{color:r,type:n}=this._board[i];t+=r===a?n.toUpperCase():n.toLowerCase()}else e++;i+1&136&&(e>0&&(t+=e),i!==_.h1&&(t+="/"),e=0,i+=8)}let r="";this._castling[a]&y.KSIDE_CASTLE&&(r+="K"),this._castling[a]&y.QSIDE_CASTLE&&(r+="Q"),this._castling[c]&y.KSIDE_CASTLE&&(r+="k"),this._castling[c]&y.QSIDE_CASTLE&&(r+="q"),r=r||"-";let n="-";if(this._epSquare!==m){const e=this._epSquare+(this._turn===a?16:-16),t=[e+1,e-1];for(const r of t){if(136&r)continue;const e=this._turn;if(this._board[r]?.color===e&&this._board[r]?.type===l){this._makeMove({color:e,from:r,to:this._epSquare,piece:l,captured:l,flags:y.EP_CAPTURE});const t=!this._isKingAttacked(e);if(this._undoMove(),t){n=L(this._epSquare);break}}}}return[t,this._turn,r,n,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==f?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(f)}get(e){return this._board[_[e]]}put({type:e,color:t},r){return!!this._put({type:e,color:t},r)&&(this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}_put({type:e,color:t},r){if(-1==="pnbrqkPNBRQK".indexOf(e.toLowerCase()))return!1;if(!(r in _))return!1;const n=_[r];if(e==g&&this._kings[t]!=m&&this._kings[t]!=n)return!1;const i=this._board[n];return i&&i.type===g&&(this._kings[i.color]=m),this._board[n]={type:e,color:t},e===g&&(this._kings[t]=n),!0}remove(e){const t=this.get(e);return delete this._board[_[e]],t&&t.type===g&&(this._kings[t.color]=m),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),t}_updateCastlingRights(){const e=this._board[_.e1]?.type===g&&this._board[_.e1]?.color===a,t=this._board[_.e8]?.type===g&&this._board[_.e8]?.color===c;e&&this._board[_.a1]?.type===d&&this._board[_.a1]?.color===a||(this._castling.w&=~y.QSIDE_CASTLE),e&&this._board[_.h1]?.type===d&&this._board[_.h1]?.color===a||(this._castling.w&=~y.KSIDE_CASTLE),t&&this._board[_.a8]?.type===d&&this._board[_.a8]?.color===c||(this._castling.b&=~y.QSIDE_CASTLE),t&&this._board[_.h8]?.type===d&&this._board[_.h8]?.color===c||(this._castling.b&=~y.KSIDE_CASTLE)}_updateEnPassantSquare(){if(this._epSquare===m)return;const e=this._epSquare+(this._turn===a?-16:16),t=this._epSquare+(this._turn===a?16:-16),r=[t+1,t-1];if(null!==this._board[e]||null!==this._board[this._epSquare]||this._board[t]?.color!==M(this._turn)||this._board[t]?.type!==l)return void(this._epSquare=m);r.some((e=>!(136&e)&&this._board[e]?.color===this._turn&&this._board[e]?.type===l))||(this._epSquare=m)}_attacked(e,t,r){const n=[];for(let i=_.a8;i<=_.h1;i++){if(136&i){i+=7;continue}if(void 0===this._board[i]||this._board[i].color!==e)continue;const o=this._board[i],s=i-t;if(0===s)continue;const u=s+119;if(w[u]&O[o.type]){if(o.type===l){if(s>0&&o.color===a||s<=0&&o.color===c){if(!r)return!0;n.push(L(i))}continue}if("n"===o.type||"k"===o.type){if(r){n.push(L(i));continue}return!0}const e=D[u];let d=i+e,h=!1;for(;d!==t;){if(null!=this._board[d]){h=!0;break}d+=e}if(!h){if(r){n.push(L(i));continue}return!0}}}return!!r&&n}attackers(e,t){return t?this._attacked(t,_[e],!0):this._attacked(this._turn,_[e],!0)}_isKingAttacked(e){const t=this._kings[e];return-1!==t&&this._attacked(M(e),t)}isAttacked(e,t){return this._attacked(t,_[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&0===this._moves().length}isStalemate(){return!this.isCheck()&&0===this._moves().length}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},t=[];let r=0,n=0;for(let i=_.a8;i<=_.h1;i++){if(n=(n+1)%2,136&i){i+=7;continue}const o=this._board[i];o&&(e[o.type]=o.type in e?e[o.type]+1:1,o.type===u&&t.push(n),r++)}if(2===r)return!0;if(3===r&&(1===e[u]||1===e.n))return!0;if(r===e[u]+2){let e=0;const r=t.length;for(let n=0;n<r;n++)e+=t[n];if(0===e||e===r)return!0}return!1}isThreefoldRepetition(){return this._getPositionCount(this.fen())>=3}isDrawByFiftyMoves(){return this._halfMoves>=100}isDraw(){return this.isDrawByFiftyMoves()||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:t,piece:r}={}){const n=this._moves({square:t,piece:r});return e?n.map((e=>new p(this,e))):n.map((e=>this._moveToSan(e,n)))}_moves({legal:e=!0,piece:t,square:r}={}){const n=r?r.toLowerCase():void 0,i=t?.toLowerCase(),o=[],s=this._turn,a=M(s);let c=_.a8,u=_.h1,d=!1;if(n){if(!(n in _))return[];c=u=_[n],d=!0}for(let f=c;f<=u;f++){if(136&f){f+=7;continue}if(!this._board[f]||this._board[f].color===a)continue;const{type:e}=this._board[f];let t;if(e===l){if(i&&i!==e)continue;t=f+S[s][0],this._board[t]||(A(o,s,f,t,l),t=f+S[s][1],k[s]!==N(f)||this._board[t]||A(o,s,f,t,l,void 0,y.BIG_PAWN));for(let e=2;e<4;e++)t=f+S[s][e],136&t||(this._board[t]?.color===a?A(o,s,f,t,l,this._board[t].type,y.CAPTURE):t===this._epSquare&&A(o,s,f,t,l,l,y.EP_CAPTURE))}else{if(i&&i!==e)continue;for(let r=0,n=E[e].length;r<n;r++){const n=E[e][r];for(t=f;t+=n,!(136&t);){if(this._board[t]){if(this._board[t].color===s)break;A(o,s,f,t,e,this._board[t].type,y.CAPTURE);break}if(A(o,s,f,t,e),"n"===e||e===g)break}}}}if(!(void 0!==i&&i!==g||d&&u!==this._kings[s])){if(this._castling[s]&y.KSIDE_CASTLE){const e=this._kings[s],t=e+2;this._board[e+1]||this._board[t]||this._attacked(a,this._kings[s])||this._attacked(a,e+1)||this._attacked(a,t)||A(o,s,this._kings[s],t,g,void 0,y.KSIDE_CASTLE)}if(this._castling[s]&y.QSIDE_CASTLE){const e=this._kings[s],t=e-2;this._board[e-1]||this._board[e-2]||this._board[e-3]||this._attacked(a,this._kings[s])||this._attacked(a,e-1)||this._attacked(a,t)||A(o,s,this._kings[s],t,g,void 0,y.QSIDE_CASTLE)}}if(!e||-1===this._kings[s])return o;const h=[];for(let l=0,g=o.length;l<g;l++)this._makeMove(o[l]),this._isKingAttacked(s)||h.push(o[l]),this._undoMove();return h}move(e,{strict:t=!1}={}){let r=null;if("string"==typeof e)r=this._moveFromSan(e,t);else if("object"==typeof e){const t=this._moves();for(let n=0,i=t.length;n<i;n++)if(e.from===L(t[n].from)&&e.to===L(t[n].to)&&(!("promotion"in t[n])||e.promotion===t[n].promotion)){r=t[n];break}}if(!r)throw"string"==typeof e?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const n=new p(this,r);return this._makeMove(r),this._incPositionCount(n.after),n}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const t=this._turn,r=M(t);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&y.EP_CAPTURE&&(this._turn===c?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:t}),this._board[e.to].type===g){if(this._kings[t]=e.to,e.flags&y.KSIDE_CASTLE){const t=e.to-1,r=e.to+1;this._board[t]=this._board[r],delete this._board[r]}else if(e.flags&y.QSIDE_CASTLE){const t=e.to+1,r=e.to-2;this._board[t]=this._board[r],delete this._board[r]}this._castling[t]=0}if(this._castling[t])for(let n=0,i=C[t].length;n<i;n++)if(e.from===C[t][n].square&&this._castling[t]&C[t][n].flag){this._castling[t]^=C[t][n].flag;break}if(this._castling[r])for(let n=0,i=C[r].length;n<i;n++)if(e.to===C[r][n].square&&this._castling[r]&C[r][n].flag){this._castling[r]^=C[r][n].flag;break}e.flags&y.BIG_PAWN?this._epSquare=t===c?e.to-16:e.to+16:this._epSquare=m,e.piece===l||e.flags&(y.CAPTURE|y.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,t===c&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();if(e){const t=new p(this,e);return this._decPositionCount(t.after),t}return null}_undoMove(){const e=this._history.pop();if(void 0===e)return null;const t=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const r=this._turn,n=M(r);if(this._board[t.from]=this._board[t.to],this._board[t.from].type=t.piece,delete this._board[t.to],t.captured)if(t.flags&y.EP_CAPTURE){let e;e=r===c?t.to-16:t.to+16,this._board[e]={type:l,color:n}}else this._board[t.to]={type:t.captured,color:n};if(t.flags&(y.KSIDE_CASTLE|y.QSIDE_CASTLE)){let e,r;t.flags&y.KSIDE_CASTLE?(e=t.to+1,r=t.to-1):(e=t.to-2,r=t.to+1),this._board[e]=this._board[r],delete this._board[r]}return t}pgn({newline:e="\n",maxWidth:t=0}={}){const r=[];let n=!1;for(const d in this._header)r.push("["+d+' "'+this._header[d]+'"]'+e),n=!0;n&&this._history.length&&r.push(e);const i=e=>{const t=this._comments[this.fen()];if(void 0!==t){e=`${e}${e.length>0?" ":""}{${t}}`}return e},o=[];for(;this._history.length>0;)o.push(this._undoMove());const s=[];let a="";for(0===o.length&&s.push(i(""));o.length>0;){a=i(a);const e=o.pop();if(!e)break;if(this._history.length||"b"!==e.color)"w"===e.color&&(a.length&&s.push(a),a=this._moveNumber+".");else{const e=`${this._moveNumber}. ...`;a=a?`${a} ${e}`:e}a=a+" "+this._moveToSan(e,this._moves({legal:!0})),this._makeMove(e)}if(a.length&&s.push(i(a)),void 0!==this._header.Result&&s.push(this._header.Result),0===t)return r.join("")+s.join(" ");const c=function(){return r.length>0&&" "===r[r.length-1]&&(r.pop(),!0)},l=function(n,i){for(const o of i.split(" "))if(o){if(n+o.length>t){for(;c();)n--;r.push(e),n=0}r.push(o),n+=o.length,r.push(" "),n++}return c()&&n--,n};let u=0;for(let d=0;d<s.length;d++)u+s[d].length>t&&s[d].includes("{")?u=l(u,s[d]):(u+s[d].length>t&&0!==d?(" "===r[r.length-1]&&r.pop(),r.push(e),u=0):0!==d&&(r.push(" "),u++),r.push(s[d]),u+=s[d].length);return r.join("")}header(...e){for(let t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(this._header[e[t]]=e[t+1]);return this._header}setHeader(e,t){return this._header[e]=t,this._header}removeHeader(e){return e in this._header&&(delete this._header[e],!0)}getHeaders(){return this._header}loadPgn(e,{strict:t=!1,newlineChar:r="\r?\n"}={}){function n(e){return e.replace(/\\/g,"\\")}e=e.trim();const i=new RegExp("^(\\[((?:"+n(r)+")|.)*\\])((?:\\s*"+n(r)+"){2}|(?:\\s*"+n(r)+")*$)").exec(e),o=i&&i.length>=2?i[1]:"";this.reset();const s=function(e){const t={},i=e.split(new RegExp(n(r)));let o="",s="";for(let r=0;r<i.length;r++){const e=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;o=i[r].replace(e,"$1"),s=i[r].replace(e,"$2"),o.trim().length>0&&(t[o]=s)}return t}(o);let a="";for(const f in s)"fen"===f.toLowerCase()&&(a=s[f]),this.header(f,s[f]);if(t){if("1"===s.SetUp){if(!("FEN"in s))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(s.FEN,{preserveHeaders:!0})}}else a&&this.load(a,{preserveHeaders:!0});const c=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(n(r),"g")," ")).slice(1,e.length-1))}}`},l=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+(e.match(/.{1,2}/g)||[]).join("%"))}(e.slice(1,e.length-1))};let u=e.replace(o,"").replace(new RegExp(`({[^}]*})+?|;([^${n(r)}]*)`,"g"),(function(e,t,r){return void 0!==t?c(t):" "+c(`{${r.slice(1)}}`)})).replace(new RegExp(n(r),"g")," ");const d=/(\([^()]+\))+?/g;for(;d.test(u);)u=u.replace(d,"");u=u.replace(/\d+\.(\.\.)?/g,""),u=u.replace(/\.\.\./g,""),u=u.replace(/\$\d+/g,"");let h=u.trim().split(new RegExp(/\s+/));h=h.filter((e=>""!==e));let g="";for(let f=0;f<h.length;f++){const e=l(h[f]);if(void 0!==e){this._comments[this.fen()]=e;continue}const r=this._moveFromSan(h[f],t);if(null==r){if(!(P.indexOf(h[f])>-1))throw new Error(`Invalid move in PGN: ${h[f]}`);g=h[f]}else g="",this._makeMove(r),this._incPositionCount(this.fen())}g&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",g)}_moveToSan(e,t){let r="";if(e.flags&y.KSIDE_CASTLE)r="O-O";else if(e.flags&y.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==l){const n=function(e,t){const r=e.from,n=e.to,i=e.piece;let o=0,s=0,a=0;for(let c=0,l=t.length;c<l;c++){const e=t[c].from,l=t[c].to;i===t[c].piece&&r!==e&&n===l&&(o++,N(r)===N(e)&&s++,R(r)===R(e)&&a++)}return o>0?s>0&&a>0?L(r):a>0?L(r).charAt(1):L(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+n}e.flags&(y.CAPTURE|y.EP_CAPTURE)&&(e.piece===l&&(r+=L(e.from)[0]),r+="x"),r+=L(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,t=!1){const r=q(e);let n,i,o,s,a,c=j(r),l=this._moves({legal:!0,piece:c});for(let d=0,h=l.length;d<h;d++)if(r===q(this._moveToSan(l[d],l)))return l[d];if(t)return null;let u=!1;if(i=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),i?(n=i[1],o=i[2],s=i[3],a=i[4],1==o.length&&(u=!0)):(i=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),i&&(n=i[1],o=i[2],s=i[3],a=i[4],1==o.length&&(u=!0))),c=j(r),l=this._moves({legal:!0,piece:n||c}),!s)return null;for(let d=0,h=l.length;d<h;d++)if(o){if(!(n&&n.toLowerCase()!=l[d].piece||_[o]!=l[d].from||_[s]!=l[d].to||a&&a.toLowerCase()!=l[d].promotion))return l[d];if(u){const e=L(l[d].from);if(!(n&&n.toLowerCase()!=l[d].piece||_[s]!=l[d].to||o!=e[0]&&o!=e[1]||a&&a.toLowerCase()!=l[d].promotion))return l[d]}}else if(r===q(this._moveToSan(l[d],l)).replace("x",""))return l[d];return null}ascii(){let e="   +------------------------+\n";for(let t=_.a8;t<=_.h1;t++){if(0===R(t)&&(e+=" "+"87654321"[N(t)]+" |"),this._board[t]){const r=this._board[t].type;e+=" "+(this._board[t].color===a?r.toUpperCase():r.toLowerCase())+" "}else e+=" . ";t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h",e}perft(e){const t=this._moves({legal:!1});let r=0;const n=this._turn;for(let i=0,o=t.length;i<o;i++)this._makeMove(t[i]),this._isKingAttacked(n)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}turn(){return this._turn}board(){const e=[];let t=[];for(let r=_.a8;r<=_.h1;r++)null==this._board[r]?t.push(null):t.push({square:L(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(t),t=[],r+=8);return e}squareColor(e){if(e in _){const t=_[e];return(N(t)+R(t))%2==0?"light":"dark"}return null}history({verbose:e=!1}={}){const t=[],r=[];for(;this._history.length>0;)t.push(this._undoMove());for(;;){const n=t.pop();if(!n)break;e?r.push(new p(this,n)):r.push(this._moveToSan(n,this._moves())),this._makeMove(n)}return r}_getPositionCount(e){const t=H(e);return this._positionCount[t]||0}_incPositionCount(e){const t=H(e);void 0===this._positionCount[t]&&(this._positionCount[t]=0),this._positionCount[t]+=1}_decPositionCount(e){const t=H(e);1===this._positionCount[t]?delete this._positionCount[t]:this._positionCount[t]-=1}_pruneComments(){const e=[],t={},r=e=>{e in this._comments&&(t[e]=this._comments[e])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const t=e.pop();if(!t)break;this._makeMove(t),r(this.fen())}this._comments=t}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){return this.removeComment()}removeComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>({fen:e,comment:this._comments[e]})))}deleteComments(){return this.removeComments()}removeComments(){return this._pruneComments(),Object.keys(this._comments).map((e=>{const t=this._comments[e];return delete this._comments[e],{fen:e,comment:t}}))}setCastlingRights(e,t){for(const n of[g,h])void 0!==t[n]&&(t[n]?this._castling[e]|=T[n]:this._castling[e]&=~T[n]);this._updateCastlingRights();const r=this.getCastlingRights(e);return!(void 0!==t[g]&&t[g]!==r[g]||void 0!==t[h]&&t[h]!==r[h])}getCastlingRights(e){return{[g]:0!=(this._castling[e]&T[g]),[h]:0!=(this._castling[e]&T[h])}}moveNumber(){return this._moveNumber}}var $=r(5893);function F(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var K="function"==typeof Symbol&&Symbol.observable||"@@observable",B=function(){return Math.random().toString(36).substring(7).split("").join(".")},G={INIT:"@@redux/INIT"+B(),REPLACE:"@@redux/REPLACE"+B(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+B()}};function Q(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function W(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(F(0));if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error(F(1));return r(W)(e,t)}if("function"!=typeof e)throw new Error(F(2));var i=e,o=t,s=[],a=s,c=!1;function l(){a===s&&(a=s.slice())}function u(){if(c)throw new Error(F(3));return o}function d(e){if("function"!=typeof e)throw new Error(F(4));if(c)throw new Error(F(5));var t=!0;return l(),a.push(e),function(){if(t){if(c)throw new Error(F(6));t=!1,l();var r=a.indexOf(e);a.splice(r,1),s=null}}}function h(e){if(!Q(e))throw new Error(F(7));if(void 0===e.type)throw new Error(F(8));if(c)throw new Error(F(9));try{c=!0,o=i(o,e)}finally{c=!1}for(var t=s=a,r=0;r<t.length;r++){(0,t[r])()}return e}return h({type:G.INIT}),(n={dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error(F(10));i=e,h({type:G.REPLACE})}})[K]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(F(11));function r(){e.next&&e.next(u())}return r(),{unsubscribe:t(r)}}})[K]=function(){return this},e},n}function z(e,t,...r){if("undefined"!=typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let n=0;e=new Error(t.replace(/%s/g,(function(){return r[n++]}))),e.name="Invariant Violation"}throw e.framesToPop=1,e}}function V(e){return"object"==typeof e}const X="dnd-core/INIT_COORDS",Y="dnd-core/BEGIN_DRAG",Z="dnd-core/PUBLISH_DRAG_SOURCE",J="dnd-core/HOVER",ee="dnd-core/DROP",te="dnd-core/END_DRAG";function re(e,t){return{type:X,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}const ne={type:X,payload:{clientOffset:null,sourceClientOffset:null}};function ie(e){return function(t=[],r={publishSource:!0}){const{publishSource:n=!0,clientOffset:i,getSourceClientOffset:o}=r,s=e.getMonitor(),a=e.getRegistry();e.dispatch(re(i)),function(e,t,r){z(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach((function(e){z(r.getSource(e),"Expected sourceIds to be registered.")}))}(t,s,a);const c=function(e,t){let r=null;for(let n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}(t,s);if(null==c)return void e.dispatch(ne);let l=null;if(i){if(!o)throw new Error("getSourceClientOffset must be defined");!function(e){z("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(o),l=o(c)}e.dispatch(re(i,l));const u=a.getSource(c).beginDrag(s,c);if(null==u)return;!function(e){z(V(e),"Item must be an object.")}(u),a.pinSource(c);const d=a.getSourceType(c);return{type:Y,payload:{itemType:d,item:u,sourceId:c,clientOffset:i||null,sourceClientOffset:l||null,isSourcePublic:!!n}}}}function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){oe(e,t,r[t])}))}return e}function ae(e){return function(t={}){const r=e.getMonitor(),n=e.getRegistry();!function(e){z(e.isDragging(),"Cannot call drop while not dragging."),z(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(r);const i=function(e){const t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(r);i.forEach(((i,o)=>{const s=function(e,t,r,n){const i=r.getTarget(e);let o=i?i.drop(n,e):void 0;(function(e){z(void 0===e||V(e),"Drop result must either be an object or undefined.")})(o),void 0===o&&(o=0===t?{}:n.getDropResult());return o}(i,o,n,r),a={type:ee,payload:{dropResult:se({},t,s)}};e.dispatch(a)}))}}function ce(e){return function(){const t=e.getMonitor(),r=e.getRegistry();!function(e){z(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);const n=t.getSourceId();if(null!=n){r.getSource(n,!0).endDrag(t,n),r.unpinSource()}return{type:te}}}function le(e,t){return null===t?null===e:Array.isArray(e)?e.some((e=>e===t)):e===t}function ue(e){return function(t,{clientOffset:r}={}){!function(e){z(Array.isArray(e),"Expected targetIds to be an array.")}(t);const n=t.slice(0),i=e.getMonitor(),o=e.getRegistry();return function(e,t,r){for(let n=e.length-1;n>=0;n--){const i=e[n];le(t.getTargetType(i),r)||e.splice(n,1)}}(n,o,i.getItemType()),function(e,t,r){z(t.isDragging(),"Cannot call hover while not dragging."),z(!t.didDrop(),"Cannot call hover after drop.");for(let n=0;n<e.length;n++){const t=e[n];z(e.lastIndexOf(t)===n,"Expected targetIds to be unique in the passed array.");z(r.getTarget(t),"Expected targetIds to be registered.")}}(n,i,o),function(e,t,r){e.forEach((function(e){r.getTarget(e).hover(t,e)}))}(n,i,o),{type:J,payload:{targetIds:n,clientOffset:r||null}}}}function de(e){return function(){if(e.getMonitor().isDragging())return{type:Z}}}class he{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:t}=this.store;const r=function(e){return{beginDrag:ie(e),publishDragSource:de(e),hover:ue(e),drop:ae(e),endDrag:ce(e)}}(this);return Object.keys(r).reduce(((n,i)=>{const o=r[i];var s;return n[i]=(s=o,(...r)=>{const n=s.apply(e,r);void 0!==n&&t(n)}),n}),{})}dispatch(e){this.store.dispatch(e)}constructor(e,t){this.isSetUp=!1,this.handleRefCountChange=()=>{const e=this.store.getState().refCount>0;this.backend&&(e&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!e&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=t,e.subscribe(this.handleRefCountChange)}}function ge(e,t){return{x:e.x-t.x,y:e.y-t.y}}const fe=[],pe=[];fe.__IS_NONE__=!0,pe.__IS_ALL__=!0;class me{subscribeToStateChange(e,t={}){const{handlerIds:r}=t;z("function"==typeof e,"listener must be a function."),z(void 0===r||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let n=this.store.getState().stateId;return this.store.subscribe((()=>{const t=this.store.getState(),i=t.stateId;try{const o=i===n||i===n+1&&!function(e,t){return e!==fe&&(e===pe||void 0===t||(r=e,t.filter((e=>r.indexOf(e)>-1))).length>0);var r}(t.dirtyHandlerIds,r);o||e()}finally{n=i}}))}subscribeToOffsetChange(e){z("function"==typeof e,"listener must be a function.");let t=this.store.getState().dragOffset;return this.store.subscribe((()=>{const r=this.store.getState().dragOffset;r!==t&&(t=r,e())}))}canDragSource(e){if(!e)return!1;const t=this.registry.getSource(e);return z(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()&&t.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const t=this.registry.getTarget(e);if(z(t,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;return le(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(e){if(!e)return!1;const t=this.registry.getSource(e,!0);if(z(t,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}isOverTarget(e,t={shallow:!1}){if(!e)return!1;const{shallow:r}=t;if(!this.isDragging())return!1;const n=this.registry.getTargetType(e),i=this.getItemType();if(i&&!le(n,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(e);return r?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(e){const{clientOffset:t,initialClientOffset:r,initialSourceClientOffset:n}=e;return t&&r&&n?ge((o=n,{x:(i=t).x+o.x,y:i.y+o.y}),r):null;var i,o}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(e){const{clientOffset:t,initialClientOffset:r}=e;return t&&r?ge(t,r):null}(this.store.getState().dragOffset)}constructor(e,t){this.store=e,this.registry=t}}const ve="undefined"!=typeof global?global:self,be=ve.MutationObserver||ve.WebKitMutationObserver;function ye(e){return function(){const t=setTimeout(n,0),r=setInterval(n,50);function n(){clearTimeout(t),clearInterval(r),e()}}}const _e="function"==typeof be?function(e){let t=1;const r=new be(e),n=document.createTextNode("");return r.observe(n,{characterData:!0}),function(){t=-t,n.data=t}}:ye;class Se{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const Ee=new class{enqueueTask(e){const{queue:t,requestFlush:r}=this;t.length||(r(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,r=e.length-this.index;t<r;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=_e(this.flush),this.requestErrorThrow=ye((()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()}))}},we=new class{create(e){const t=this.freeTasks,r=t.length?t.pop():new Se(this.onError,(e=>t[t.length]=e));return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}(Ee.registerPendingError);const De="dnd-core/ADD_SOURCE",Oe="dnd-core/ADD_TARGET",Ie="dnd-core/REMOVE_SOURCE",Te="dnd-core/REMOVE_TARGET";function Ce(e,t){t&&Array.isArray(e)?e.forEach((e=>Ce(e,!1))):z("string"==typeof e||"symbol"==typeof e,t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var ke;!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(ke||(ke={}));let Pe=0;function Ne(e){const t=(Pe++).toString();switch(e){case ke.SOURCE:return`S${t}`;case ke.TARGET:return`T${t}`;default:throw new Error(`Unknown Handler Role: ${e}`)}}function Re(e){switch(e[0]){case"S":return ke.SOURCE;case"T":return ke.TARGET;default:throw new Error(`Cannot parse handler ID: ${e}`)}}function xe(e,t){const r=e.entries();let n=!1;do{const{done:e,value:[,i]}=r.next();if(i===t)return!0;n=!!e}while(!n);return!1}class Le{addSource(e,t){Ce(e),function(e){z("function"==typeof e.canDrag,"Expected canDrag to be a function."),z("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),z("function"==typeof e.endDrag,"Expected endDrag to be a function.")}(t);const r=this.addHandler(ke.SOURCE,e,t);return this.store.dispatch(function(e){return{type:De,payload:{sourceId:e}}}(r)),r}addTarget(e,t){Ce(e,!0),function(e){z("function"==typeof e.canDrop,"Expected canDrop to be a function."),z("function"==typeof e.hover,"Expected hover to be a function."),z("function"==typeof e.drop,"Expected beginDrag to be a function.")}(t);const r=this.addHandler(ke.TARGET,e,t);return this.store.dispatch(function(e){return{type:Oe,payload:{targetId:e}}}(r)),r}containsHandler(e){return xe(this.dragSources,e)||xe(this.dropTargets,e)}getSource(e,t=!1){z(this.isSourceId(e),"Expected a valid source ID.");return t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return z(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return z(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return z(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return Re(e)===ke.SOURCE}isTargetId(e){return Re(e)===ke.TARGET}removeSource(e){var t;z(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:Ie,payload:{sourceId:e}}}(e)),t=()=>{this.dragSources.delete(e),this.types.delete(e)},Ee.enqueueTask(we.create(t))}removeTarget(e){z(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:Te,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const t=this.getSource(e);z(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}unpinSource(){z(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,t,r){const n=Ne(e);return this.types.set(n,t),e===ke.SOURCE?this.dragSources.set(n,r):e===ke.TARGET&&this.dropTargets.set(n,r),n}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const Me=(e,t)=>e===t;function Ae(e=fe,t){switch(t.type){case J:break;case De:case Oe:case Te:case Ie:return fe;default:return pe}const{targetIds:r=[],prevTargetIds:n=[]}=t.payload,i=function(e,t){const r=new Map,n=e=>{r.set(e,r.has(e)?r.get(e)+1:1)};e.forEach(n),t.forEach(n);const i=[];return r.forEach(((e,t)=>{1===e&&i.push(t)})),i}(r,n);if(!(i.length>0||!function(e,t,r=Me){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!r(e[n],t[n]))return!1;return!0}(r,n)))return fe;const o=n[n.length-1],s=r[r.length-1];return o!==s&&(o&&i.push(o),s&&i.push(s)),i}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const qe={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function He(e=qe,t){const{payload:r}=t;switch(t.type){case X:case Y:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case J:return n=e.clientOffset,i=r.clientOffset,!n&&!i||n&&i&&n.x===i.x&&n.y===i.y?e:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){je(e,t,r[t])}))}return e}({},e,{clientOffset:r.clientOffset});case te:case ee:return qe;default:return e}var n,i}function Ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ue(e,t,r[t])}))}return e}const Fe={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Ke(e=Fe,t){const{payload:r}=t;switch(t.type){case Y:return $e({},e,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case Z:return $e({},e,{isSourcePublic:!0});case J:return $e({},e,{targetIds:r.targetIds});case Te:return-1===e.targetIds.indexOf(r.targetId)?e:$e({},e,{targetIds:(n=e.targetIds,i=r.targetId,n.filter((e=>e!==i)))});case ee:return $e({},e,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case te:return $e({},e,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}var n,i}function Be(e=0,t){switch(t.type){case De:case Oe:return e+1;case Ie:case Te:return e-1;default:return e}}function Ge(e=0){return e+1}function Qe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Qe(e,t,r[t])}))}return e}function ze(e={},t){return{dirtyHandlerIds:Ae(e.dirtyHandlerIds,{type:t.type,payload:We({},t.payload,{prevTargetIds:(r=e,n="dragOperation.targetIds",i=[],n.split(".").reduce(((e,t)=>e&&e[t]?e[t]:i||null),r))})}),dragOffset:He(e.dragOffset,t),refCount:Be(e.refCount,t),dragOperation:Ke(e.dragOperation,t),stateId:Ge(e.stateId)};var r,n,i}function Ve(e,t=void 0,r={},n=!1){const i=function(e){const t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return W(ze,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(n),o=new me(i,new Le(i)),s=new he(i,o),a=e(s,t,r);return s.receiveBackend(a),s}const Xe=(0,i.createContext)({dragDropManager:void 0});function Ye(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}let Ze=0;const Je=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var et=(0,i.memo)((function(e){var{children:t}=e,r=Ye(e,["children"]);const[n,o]=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}const t=function(e,t=tt(),r,n){const i=t;i[Je]||(i[Je]={dragDropManager:Ve(e,t,r,n)});return i[Je]}(e.backend,e.context,e.options,e.debugMode),r=!e.context;return[t,r]}(r);return(0,i.useEffect)((()=>{if(o){const e=tt();return++Ze,()=>{0==--Ze&&(e[Je]=null)}}}),[]),(0,$.jsx)(Xe.Provider,{value:n,children:t})}));function tt(){return"undefined"!=typeof global?global:window}function rt(e){let t=null;return()=>(null==t&&(t=e()),t)}class nt{enter(e){const t=this.entered.length;return this.entered=function(e,t){const r=new Set,n=e=>r.add(e);e.forEach(n),t.forEach(n);const i=[];return r.forEach((e=>i.push(e))),i}(this.entered.filter((t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e)))),[e]),0===t&&this.entered.length>0}leave(e){const t=this.entered.length;var r,n;return this.entered=(r=this.entered.filter(this.isNodeInDocument),n=e,r.filter((e=>e!==n))),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class it{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach((e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})}))}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach((r=>{const n=this.config.exposeProperties[r];null!=n&&(t[r]={value:n(e,this.config.matchesTypes),configurable:!0,enumerable:!0})})),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const ot="__NATIVE_FILE__",st="__NATIVE_URL__",at="__NATIVE_TEXT__",ct="__NATIVE_HTML__";function lt(e,t,r){const n=t.reduce(((t,r)=>t||e.getData(r)),"");return null!=n?n:r}const ut={[ot]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[ct]:{exposeProperties:{html:(e,t)=>lt(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[st]:{exposeProperties:{urls:(e,t)=>lt(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[at]:{exposeProperties:{text:(e,t)=>lt(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};function dt(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(ut).filter((e=>{const r=ut[e];return!!(null==r?void 0:r.matchesTypes)&&r.matchesTypes.some((e=>t.indexOf(e)>-1))}))[0]||null}const ht=rt((()=>/firefox/i.test(navigator.userAgent))),gt=rt((()=>Boolean(window.safari)));class ft{interpolate(e){const{xs:t,ys:r,c1s:n,c2s:i,c3s:o}=this;let s=t.length-1;if(e===t[s])return r[s];let a,c=0,l=o.length-1;for(;c<=l;){a=Math.floor(.5*(c+l));const n=t[a];if(n<e)c=a+1;else{if(!(n>e))return r[a];l=a-1}}s=Math.max(0,l);const u=e-t[s],d=u*u;return r[s]+n[s]*u+i[s]*d+o[s]*u*d}constructor(e,t){const{length:r}=e,n=[];for(let g=0;g<r;g++)n.push(g);n.sort(((t,r)=>e[t]<e[r]?-1:1));const i=[],o=[],s=[];let a,c;for(let g=0;g<r-1;g++)a=e[g+1]-e[g],c=t[g+1]-t[g],o.push(a),i.push(c),s.push(c/a);const l=[s[0]];for(let g=0;g<o.length-1;g++){const e=s[g],t=s[g+1];if(e*t<=0)l.push(0);else{a=o[g];const r=o[g+1],n=a+r;l.push(3*n/((n+r)/e+(n+a)/t))}}l.push(s[s.length-1]);const u=[],d=[];let h;for(let g=0;g<l.length-1;g++){h=s[g];const e=l[g],t=1/o[g],r=e+l[g+1]-h-h;u.push((h-e-r)*t),d.push(r*t*t)}this.xs=e,this.ys=t,this.c1s=l,this.c2s=u,this.c3s=d}}const pt=1;function mt(e){const t=e.nodeType===pt?e:e.parentElement;if(!t)return null;const{top:r,left:n}=t.getBoundingClientRect();return{x:n,y:r}}function vt(e){return{x:e.clientX,y:e.clientY}}function bt(e,t,r,n,i){const o="IMG"===(s=t).nodeName&&(ht()||!(null===(a=document.documentElement)||void 0===a?void 0:a.contains(s)));var s,a;const c=mt(o?e:t),l={x:r.x-c.x,y:r.y-c.y},{offsetWidth:u,offsetHeight:d}=e,{anchorX:h,anchorY:g}=n,{dragPreviewWidth:f,dragPreviewHeight:p}=function(e,t,r,n){let i=e?t.width:r,o=e?t.height:n;return gt()&&e&&(o/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:o}}(o,t,u,d),{offsetX:m,offsetY:v}=i,b=0===v||v;return{x:0===m||m?m:new ft([0,.5,1],[l.x,l.x/u*f,l.x+f-u]).interpolate(h),y:b?v:(()=>{let e=new ft([0,.5,1],[l.y,l.y/d*p,l.y+p-d]).interpolate(g);return gt()&&o&&(e+=(window.devicePixelRatio-1)*p),e})()}}class yt{get window(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}}function _t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_t(e,t,r[t])}))}return e}class Et{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;var t;void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)))}connectDragPreview(e,t,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,r){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,r);const n=t=>this.handleDragStart(t,e),i=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",n),t.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",n),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const r=t=>this.handleDragEnter(t,e),n=t=>this.handleDragOver(t,e),i=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",r),t.addEventListener("dragover",n),t.addEventListener("drop",i),()=>{t.removeEventListener("dragenter",r),t.removeEventListener("dragover",n),t.removeEventListener("drop",i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return St({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId();return St({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(n).some((t=>n[t]===e))}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){const r=ut[e];if(!r)throw new Error(`native type ${e} has no configuration`);const n=new it(r);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout((()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}),1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&mt(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>Boolean(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{const e=this.currentDragSourceNode;null==e||this.isNodeInDocument(e)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=e=>{null===this.hoverRafId&&"undefined"!=typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame((()=>{this.monitor.isDragging()&&this.actions.hover(e||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null})))},this.cancelHover=()=>{null!==this.hoverRafId&&"undefined"!=typeof cancelAnimationFrame&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;const{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;const r=vt(e);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:r});const{dataTransfer:n}=e,i=dt(n);if(this.monitor.isDragging()){if(n&&"function"==typeof n.setDragImage){const e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),i=this.sourcePreviewNodes.get(e)||t;if(i){const{anchorX:e,anchorY:o,offsetX:s,offsetY:a}=this.getCurrentSourcePreviewNodeOptions(),c=bt(t,i,r,{anchorX:e,anchorY:o},{offsetX:s,offsetY:a});n.setDragImage(i,c.x,c.y)}}try{null==n||n.setData("application/json",{})}catch(o){}this.setCurrentDragSourceNode(e.target);const{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout((()=>this.actions.publishDragSource()),0)}else if(i)this.beginDragNativeItem(i);else{if(n&&!n.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=e=>{var t;(this.dragEnterTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;const{dataTransfer:r}=e,n=dt(r);n&&this.beginDragNativeItem(n,r)},this.handleTopDragEnter=e=>{const{dragEnterTargetIds:t}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:vt(e)});t.some((e=>this.monitor.canDropOnTarget(e)))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=e=>{var t;(this.dragOverTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=e=>{const{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));this.altKeyPressed=e.altKey,this.lastClientOffset=vt(e),this.scheduleHover(t);(t||[]).some((e=>this.monitor.canDropOnTarget(e)))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault();this.enterLeaveCounter.leave(e.target)&&(this.isDraggingNativeItem()&&setTimeout((()=>this.endDragNativeItem()),0),this.cancelHover())},this.handleTopDropCapture=e=>{var t;(this.dropTargetIds=[],this.isDraggingNativeItem())?(e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):dt(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{const{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:vt(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=e=>{const t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new yt(t,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new nt(this.isNodeInDocument)}}const wt=function(e,t,r){return new Et(e,t,r)};function Dt(){const{0:e}=(0,i.useState)(new U),{0:t,1:r}=(0,i.useState)(e.board()),{0:n,1:o}=(0,i.useState)("w"),{0:a,1:c}=(0,i.useState)([]),l=(0,i.useMemo)((()=>"undefined"!=typeof window?new Audio("/move.ogg"):null),[]);(0,i.useEffect)((()=>{l&&(l.preload="auto")}),[l]);const u=(0,i.useCallback)((t=>{try{return e.move(t),null==l||l.play(),r(e.board()),c((e=>[].concat((0,s.Z)(e),[t]))),o(e.turn()),!0}catch(n){return!1}}),[e,l]);return{chess:e,board:t,turn:n,moveHistory:a,movePiece:u,undoMove:()=>{e.undo(),r(e.board()),c(a.slice(0,-1)),o(e.turn())}}}var Ot=r(4063);const It="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;function Tt(e,t,r){const[n,o]=function(e,t,r){const[n,o]=(0,i.useState)((()=>t(e))),s=(0,i.useCallback)((()=>{const i=t(e);Ot(n,i)||(o(i),r&&r())}),[n,e,r]);return It(s),[n,s]}(e,t,r);return It((function(){const t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(o,{handlerIds:[t]})}),[e,o]),n}function Ct(e,t,r){return Tt(t,e||(()=>({})),(()=>r.reconnect()))}function kt(e,t){const r=[...t||[]];return null==t&&"function"!=typeof e&&r.push(e),(0,i.useMemo)((()=>"function"==typeof e?e():e),r)}function Pt(e){return(0,i.useMemo)((()=>e.hooks.dragSource()),[e])}function Nt(e){return(0,i.useMemo)((()=>e.hooks.dragPreview()),[e])}function Rt(e,t,r,n){let i=r?r.call(n,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;const o=Object.keys(e),s=Object.keys(t);if(o.length!==s.length)return!1;const a=Object.prototype.hasOwnProperty.bind(t);for(let c=0;c<o.length;c++){const s=o[c];if(!a(s))return!1;const l=e[s],u=t[s];if(i=r?r.call(n,l,u,s):void 0,!1===i||void 0===i&&l!==u)return!1}return!0}function xt(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function Lt(e){return(t=null,r=null)=>{if(!(0,i.isValidElement)(t)){const n=t;return e(n,r),n}const n=t;!function(e){if("string"==typeof e.type)return;const t=e.type.displayName||e.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${t} into a <div>, or turn it into a drag source or a drop target itself.`)}(n);return function(e,t){const r=e.ref;return z("string"!=typeof r,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),r?(0,i.cloneElement)(e,{ref:e=>{At(r,e),At(t,e)}}):(0,i.cloneElement)(e,{ref:t})}(n,r?t=>e(t,r):e)}}function Mt(e){const t={};return Object.keys(e).forEach((r=>{const n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{const e=Lt(n);t[r]=()=>e}})),t}function At(e,t){"function"==typeof e?e(t):e.current=t}class jt{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId?e?(t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),t):(this.lastConnectedDragSource=e,t):t}reconnectDragPreview(e=!1){const t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();r&&this.disconnectDragPreview(),this.handlerId&&(t?r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions)):this.lastConnectedDragPreview=t)}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Rt(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Rt(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=Mt({dragSource:(e,t)=>{this.clearDragSource(),this.dragSourceOptions=t||null,xt(e)?this.dragSourceRef=e:this.dragSourceNode=e,this.reconnectDragSource()},dragPreview:(e,t)=>{this.clearDragPreview(),this.dragPreviewOptions=t||null,xt(e)?this.dragPreviewRef=e:this.dragPreviewNode=e,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}function qt(){const{dragDropManager:e}=(0,i.useContext)(Xe);return z(null!=e,"Expected drag drop context"),e}let Ht=!1,Ut=!1;class $t{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){z(!Ht,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ht=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Ht=!1}}isDragging(){if(!this.sourceId)return!1;z(!Ut,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ut=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Ut=!1}}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,t){return this.internalMonitor.isOverTarget(e,t)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}class Ft{beginDrag(){const e=this.spec,t=this.monitor;let r=null;return r="object"==typeof e.item?e.item:"function"==typeof e.item?e.item(t):{},null!=r?r:null}canDrag(){const e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}isDragging(e,t){const r=this.spec,n=this.monitor,{isDragging:i}=r;return i?i(n):t===e.getSourceId()}endDrag(){const e=this.spec,t=this.monitor,r=this.connector,{end:n}=e;n&&n(t.getItem(),t),r.reconnect()}constructor(e,t,r){this.spec=e,this.monitor=t,this.connector=r}}function Kt(e,t,r){const n=qt(),o=function(e,t,r){const n=(0,i.useMemo)((()=>new Ft(e,t,r)),[t,r]);return(0,i.useEffect)((()=>{n.spec=e}),[e]),n}(e,t,r),s=function(e){return(0,i.useMemo)((()=>{const t=e.type;return z(null!=t,"spec.type must be defined"),t}),[e])}(e);It((function(){if(null!=s){const[e,i]=function(e,t,r){const n=r.getRegistry(),i=n.addSource(e,t);return[i,()=>n.removeSource(i)]}(s,o,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),i}}),[n,t,r,o,s])}function Bt(e,t){const r=kt(e,t);z(!r.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const n=function(){const e=qt();return(0,i.useMemo)((()=>new $t(e)),[e])}(),o=function(e,t){const r=qt(),n=(0,i.useMemo)((()=>new jt(r.getBackend())),[r]);return It((()=>(n.dragSourceOptions=e||null,n.reconnect(),()=>n.disconnectDragSource())),[n,e]),It((()=>(n.dragPreviewOptions=t||null,n.reconnect(),()=>n.disconnectDragPreview())),[n,t]),n}(r.options,r.previewOptions);return Kt(r,n,o),[Ct(r.collect,n,o),Pt(o),Nt(o)]}var Gt=r(8032);var Qt=e=>{var t,r;let{piece:n}=e;const s=(0,o.K2)("2805664565"),a=`${n.color}${n.type}`,c=null==s||null===(t=s.allFile)||void 0===t?void 0:t.nodes.find((e=>e.relativePath===`${a}.png`));return i.createElement(Gt.G,{image:null==c||null===(r=c.childImageSharp)||void 0===r?void 0:r.gatsbyImageData,alt:a})};var Wt=e=>{let{piece:t,square:r,addHighlights:n,removeHighlights:o}=e,s=!1;const[{isDragging:a},c]=Bt((()=>({type:"CHESS_PIECE",item:()=>(s||(n(r),s=!0),{piece:t,square:r}),collect:e=>({isDragging:!!e.isDragging()}),end:(e,t)=>{o(),s=!1}})));return i.createElement("div",{ref:c.bind(void 0),style:{opacity:a?.2:1}},i.createElement(Qt,{piece:t}))};function zt(e){return(0,i.useMemo)((()=>e.hooks.dropTarget()),[e])}class Vt{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Rt(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=Mt({dropTarget:(e,t)=>{this.clearDropTarget(),this.dropTargetOptions=t,xt(e)?this.dropTargetRef=e:this.dropTargetNode=e,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}let Xt=!1;class Yt{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}canDrop(){if(!this.targetId)return!1;z(!Xt,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Xt=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Xt=!1}}isOver(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}class Zt{canDrop(){const e=this.spec,t=this.monitor;return!e.canDrop||e.canDrop(t.getItem(),t)}hover(){const e=this.spec,t=this.monitor;e.hover&&e.hover(t.getItem(),t)}drop(){const e=this.spec,t=this.monitor;if(e.drop)return e.drop(t.getItem(),t)}constructor(e,t){this.spec=e,this.monitor=t}}function Jt(e,t,r){const n=qt(),o=function(e,t){const r=(0,i.useMemo)((()=>new Zt(e,t)),[t]);return(0,i.useEffect)((()=>{r.spec=e}),[e]),r}(e,t),s=function(e){const{accept:t}=e;return(0,i.useMemo)((()=>(z(null!=e.accept,"accept must be defined"),Array.isArray(t)?t:[t])),[t])}(e);It((function(){const[e,i]=function(e,t,r){const n=r.getRegistry(),i=n.addTarget(e,t);return[i,()=>n.removeTarget(i)]}(s,o,n);return t.receiveHandlerId(e),r.receiveHandlerId(e),i}),[n,t,o,r,s.map((e=>e.toString())).join("|")])}function er(e,t){const r=kt(e,t),n=function(){const e=qt();return(0,i.useMemo)((()=>new Yt(e)),[e])}(),o=function(e){const t=qt(),r=(0,i.useMemo)((()=>new Vt(t.getBackend())),[t]);return It((()=>(r.dropTargetOptions=e||null,r.reconnect(),()=>r.disconnectDropTarget())),[e]),r}(r.options);return Jt(r,n,o),[Ct(r.collect,n,o),zt(o)]}var tr=e=>{let{square:t,children:r,onDrop:n,onClick:o,isHighlighted:s,isSelected:a,isPromotion:c}=e;const[{isOver:l},u]=er((()=>({accept:"CHESS_PIECE",drop:e=>{n(e.square,t)},collect:e=>({isOver:!!e.isOver()})})));return i.createElement("div",{ref:u,"data-square":t,"aria-label":t,"aria-roledescription":"Square",role:"button",tabIndex:0,className:`cellStyle\n        ${l?"drop-hover":""}\n        ${s?"highlight":""}\n        ${a?"selected":""}\n        ${c?"promotion":""}`,onClick:()=>o(t),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||o(t)}},r)};var rr=()=>{const{board:e,turn:t,moveHistory:r,movePiece:n,undoMove:o,chess:a}=Dt(),{0:c,1:l}=(0,i.useState)([]),{0:u,1:d}=(0,i.useState)(null),{0:h,1:g}=(0,i.useState)([]),{0:f,1:p}=(0,i.useState)(null),{0:m,1:v}=(0,i.useState)([]),y=e=>{n(e)&&(()=>{if(a.isGameOver()){const e=a.isCheckmate(),t=a.isStalemate(),r=a.isDraw(),n=a.isThreefoldRepetition(),i=a.isDrawByFiftyMoves(),o=a.isInsufficientMaterial();if(e){const e="w"===a.turn()?"Black":"White";alert("Game over, "+e+" wins")}else t?alert("Game over, stalemate"):r?alert("Game over, draw"):n?alert("Game over, threefold repetition"):i?alert("Game over, fifty moves"):o&&alert("Game over, insufficient material")}})()},_=()=>{g([]),p(null),v([]),l([])},S=e=>{if(e.includes("O-O-O"))return"w"===a.turn()?"c1":"c8";if(e.includes("O-O"))return"w"===a.turn()?"g1":"g8";let t=e.replace(/[+#]/g,"");t.includes("=")&&(t=t.substring(0,t.indexOf("=")));const r=t.slice(-2);return/^[a-h][1-8]$/.test(r)?r:null},E=e=>{if(!e)return;p(e);const t=a.moves({square:e});l(t),t.forEach((e=>{const t=e.includes("="),r=e.includes("O-O");if(t){const t=S(e);v([t])}else if(r){const t=e.includes("O-O-O"),r=a.turn();let n="w"===r?"g1":"g8";t&&(n="w"===r?"c1":"c8"),g((e=>[].concat((0,s.Z)(e),[n])))}else{const t=S(e);g((e=>[].concat((0,s.Z)(e),[t])))}}))},w=e=>{const t=a.get(f);if(!t)return!1;const r=t&&"p"===t.type,n="w"===t.color&&"8"===e[1]||"b"===t.color&&"1"===e[1];return r&&n},D=e=>{if(e&&!u)if(l([]),_(),f){const t=a.get(e);if(t){if(t.color===a.turn())return;w(e)?d({from:f,to:e}):y({from:f,to:e})}else w(e)?d({from:f,to:e}):(p(null),y({from:f,to:e}))}else E(e)},O=e=>{e&&u?(y({...u,promotion:e}),d(null)):d(null)},I=(e,t)=>{if(e===t)return;const r=a.get(e);if(r){if("p"===r.type){if("w"===r.color&&"8"===t[1]||"b"===r.color&&"1"===t[1])return void d({from:e,to:t})}y({from:e,to:t}),p(null),_()}};return i.createElement(et,{backend:wt},i.createElement("div",{className:"boardComponent"},i.createElement("div",{className:"boardContainer"},i.createElement("div",{className:"boardStyle"},e.map(((e,t)=>i.createElement("div",{key:t,className:"rowStyle"},e.map(((e,r)=>{const n=b[8*t+r];return i.createElement(tr,{key:r,square:n,onDrop:I,onClick:D,isSelected:f===n,isHighlighted:h.includes(n),isPromotion:m.includes(n)},(null==e?void 0:e.type)&&i.createElement(Wt,{piece:{type:e.type,color:e.color},square:n,addHighlights:E.bind(void 0,n),removeHighlights:_.bind(void 0,n)}))})),i.createElement("div",{className:"coordinateLabel rankLabel"},8-t)))),i.createElement("div",{className:"rowStyle fileLabels"},["a","b","c","d","e","f","g","h"].map(((e,t)=>i.createElement("div",{key:t,className:"coordinateLabel fileLabel"},e)))))),i.createElement("div",{className:"infoContainer"},i.createElement("p",{className:"turn"},"Turn: ",t),i.createElement("p",{className:"selectedCell"},"Selected: ",f),i.createElement("div",{className:"legalMoves"},i.createElement("p",null,"Legal Moves:"),c.map(((e,t)=>i.createElement("span",{key:t},e," ")))),i.createElement("div",{className:"moveHistory"},i.createElement("p",null,"Move History:"),i.createElement("div",{className:"moveHistoryList"},r.map(((e,t)=>i.createElement("span",{className:"move",key:t},e.from," ",e.to," "))))),i.createElement("button",{onClick:()=>{o()}},"Undo"),u&&i.createElement("div",{className:"promotionDialog"},i.createElement("p",null,"Choose promotion piece:"),i.createElement("select",{onChange:e=>O(e.target.value),defaultValue:""},i.createElement("option",{value:"",disabled:!0},"Select a piece"),i.createElement("option",{value:"q"},"Queen"),i.createElement("option",{value:"r"},"Rook"),i.createElement("option",{value:"b"},"Bishop"),i.createElement("option",{value:"n"},"Knight")),i.createElement("button",{onClick:()=>O(null)},"Cancel")))))};const nr=(0,i.createContext)();function ir(e){let{children:t}=e;const r=Dt();return i.createElement(nr.Provider,{value:r},t)}var or=()=>i.createElement(ir,null,i.createElement("main",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},i.createElement("h1",null,"Quick Chess"),i.createElement(rr,null),i.createElement(o.rU,{to:"/about",style:{marginTop:"20px",color:"white"}},"About")));const sr=()=>i.createElement("title",null,"quick-chess")}}]);
//# sourceMappingURL=component---src-pages-index-js-69982ac8d6918c00e791.js.map